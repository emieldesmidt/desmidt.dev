<!DOCTYPE html>
<html>

<head>
    <script src="https://unpkg.com/konva@8.3.5/konva.min.js"></script>
    <meta charset="utf-8" />
    <title>Master the mind!</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #ffffff;
        }
    </style>
</head>

<body>
    <p id="p1">Hello sWorld!</p>
    <div id="container"></div>
    <script>

        // stage and layer construction
        const width = window.innerWidth;
        const height = window.innerHeight;

        const stage = new Konva.Stage({
            container: 'container',
            width: width,
            height: height,
        });
        const layer = new Konva.Layer();


        // global variables
        const dot_radius = width / 30;
        const spacing = 65
        const colours = ['#cc0000', '#e69138', '#f1c232', '#6aa84f', '#45818e']

        var group = new Konva.Group({
            clipFunc: function (ctx) {
                ctx.arc(100, 100, 75, 0, Math.PI * 2, false);
                ctx.arc(width * 0.5, height * 0.5, height * 0.1, 0, Math.PI * 2, false);
                ctx.rect(width - 150, height * .5, height * 0.1, height * .6)
                ctx.arc(width - 100, height - 100, 75, 0, Math.PI * 2, false);
            },
        });

        group.add(new Konva.Rect({
            x: 0,
            y: 0,
            width: width,
            height: height,
            fill: '#e4e4e4',
            visible: false,
            id: 'reveal_map',
        }));

        const circle = new Konva.Circle({
            x: 100,
            y: 100,
            radius: dot_radius,
            fill: colours[4],
            shadowBlur: 50,
            shadowOffset: { x: 2, y: 5 },
            shadowOpacity: 1,
            shadowEnabled: true,
            draggable: true,
        });

        const destination = new Konva.Circle({
            x: width - 100,
            y: height - 100,
            radius: dot_radius,
            fill: colours[1],
            shadowBlur: 100,
            shadowOffset: { x: 2, y: 5 },
            shadowOpacity: 1,
            shadowEnabled: true,
            draggable: true
        });

        group.add(circle)
        group.add(destination)


        layer.add(group)

        const reveal = new Konva.Circle({
            x: width * .95,
            y: height * .10,
            radius: dot_radius,
            stroke: 'gray',
            strokeWidth: 1,
            id: 'reveal_button',
        })
        reveal.on('click touchstart', function () {
            const reveal_map = stage.find('#reveal_map')[0]
            reveal_map.visible(!reveal_map.visible())
        });
        layer.add(reveal)

        stage.add(layer);

        window.addEventListener("deviceorientation", handleOrientation, true);
        function handleOrientation(event) {
            var absolute = event.absolute;
            var alpha = event.alpha;
            var beta = event.beta;
            var gamma = event.gamma;
            console.log(absolute, alpha, beta, gamma)
            document.getElementById("p1").innerHTML = absolute + ' ' + alpha + ' ' + beta + ' ' + gamma + ' ';

        }

    </script>
</body>

</html>