<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Mastermind</title>
    <style>
      * { padding: 0; margin: 0; }
      canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="myCanvas" width="480" height="320"></canvas>

<script>
  const canvas = document.getElementById("myCanvas");
  const ctx = canvas.getContext("2d");
  const colours = ['#cc0000', '#e69138', '#f1c232', '#6aa84f', '#45818e']

  const shuffler = (array) => {
    return array.slice().sort( () => Math.random() - 0.5);
  }

  const resize = () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }

  resize()
  window.addEventListener('resize', resize)

  const draw_blank_row = () => {
    ctx.strokeStyle = "rgba(0, 0, 0, 0.5)";
    
    const steps = 4
    const spacing = 65

    x_positions = [...Array(steps).keys()].map(pos => (canvas.width / 2) - ( (spacing * steps) / 2 ) + ( pos * spacing ))

    for (let step = 0; step < steps; step++) {
      ctx.beginPath();
      ctx.arc(x_positions[step], canvas.height / 2, 20, 0, Math.PI*2, false);
      ctx.stroke();
      ctx.closePath();
    }
  }

  const draw_previous_row = (colours, correct_pos, correct_col, row) => {
    
    const steps = 6
    const spacing = 65
    const height = canvas.height / 2 + (row * spacing)

    x_positions = [...Array(steps).keys()].map(pos => (canvas.width / 2) - ( (spacing * steps) / 2 ) + ( pos * spacing ))

    ctx.fillStyle = 'gray'
    ctx.font = '40pt Calibri';
    ctx.fillText(correct_pos, x_positions[0]- 15, height + 15);

    for (let step = 0; step < steps - 2; step++) {
      ctx.beginPath();
      ctx.arc(x_positions[step + 1], height, 20, 0, Math.PI*2, false);
      ctx.fillStyle = colours[step]
      ctx.fill();
      ctx.closePath();
    }
    
    ctx.fillStyle = 'gray'
    ctx.fillText(correct_col, x_positions[5], height + 15);

  }

  draw_blank_row()
  draw_previous_row(colours.slice(0, 4), 4, 1, 1)

  const check = (attempt, answer) => {
    let correct_col = 0
    let correct_pos = 0

    for (var i = 0; i < attempt.length; i++) {
      let attempt_i = attempt[i]
      let answer_i = answer[i]

      correct_pos += attempt_i === answer_i
      correct_col += answer.includes(attempt_i)
    }

    correct_col -= correct_pos
    return {correct_col: correct_col, correct_pos: correct_pos}
  }

  console.log(colours)
  shu = shuffler(colours)
  console.log(shu)
  console.log(check(shu, colours))

</script>

</body>
</html>
